cmake_minimum_required(VERSION 3.21)
project(anyany)

include(CTest)

if(BUILD_TESTING)
	set(ANYANY_TEST ${CMAKE_CURRENT_SOURCE_DIR}/tests/test_anyany.cpp)
	file(GLOB ANYANY_EXAMPLES REGULAR_EXPRESSION ${CMAKE_CURRENT_SOURCE_DIR}/examples/*)
endif()
add_executable(anyany ${CMAKE_CURRENT_SOURCE_DIR}/include/anyany.hpp ${ANYANY_TEST} ${ANYANY_EXAMPLES})
set_property(TARGET anyany PROPERTY CMAKE_CXX_EXTENSIONS OFF)
target_include_directories(anyany PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/include)

add_library(anyanylib INTERFACE ${CMAKE_CURRENT_SOURCE_DIR}/include/anyany.hpp)
target_include_directories(anyanylib INTERFACE ${CMAKE_CURRENT_SOURCE_DIR}/include)
set_property(TARGET anyanylib PROPERTY CMAKE_CXX_EXTENSIONS OFF)
source_group(Include FILES ${CMAKE_CURRENT_SOURCE_DIR}/include/anyany.hpp)
if(BUILD_TESTING)
	source_group(Examples FILES ${ANYANY_EXAMPLES})
	target_include_directories(anyany PRIVATE examples)
	source_group(Tests FILES ${ANYANY_TEST})
	source_group(Include FILES ${CMAKE_CURRENT_SOURCE_DIR}/include/anyany.hpp)
	add_subdirectory(tests)
endif()
set_property(TARGET anyany PROPERTY CMAKE_CXX_STANDARD_REQUIRED ON)
set_property(TARGET anyany PROPERTY CXX_STANDARD 23)